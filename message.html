<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sanctuary | Message</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="message-page">

<div id="auth-gate">
    <div class="auth-card">
        <h1>Access Key</h1>
        <input type="password" id="pass-input" placeholder="â€¢â€¢â€¢â€¢">
        <button class="unlock-btn" onclick="unlockHub()">Unlock Sanctuary</button>
    </div>
</div>

<div id="message-auth-gate" style="display:none;">
    <div class="auth-card">
        <h1>Private Message</h1>
        <input type="password" id="message-pass-input" placeholder="â€¢â€¢â€¢â€¢">
        <button class="unlock-btn" onclick="unlockMessage()">Unlock Message</button>
    </div>
</div>

<nav class="nav-pill" style="display:none;">
    <a href="index.html">Home</a>
    <a href="message.html" class="active">Message</a>
    <a href="memories.html">Memories</a>
    <a href="photos.html">Photos</a>
    <a href="awesome.html">Awesome</a>
    <button class="logout-btn" onclick="logout()">Logout</button>
</nav>

<main class="container" style="display:none;">
    <div class="speech-bubble" style="max-width:800px; margin:0 auto;">
        <h2 style="color:var(--neon); margin-top:0;">Dear Sunny,</h2>

        <p class="typing-text">
            Happy 18th birthday!
            What a long way you've already come, right?
            It's almost unbelievable that I've known you for a year now â€” and that I get to be here as you step into such an important milestone.
            I wanted to give you something that wouldn't disappear after today â€” something you could come back to.
            Not just words to read once, but a space to exist in.
            A place where you can create, wander, look back on good moments, or simply rest when everything feels like too much.
            Somewhere that gently reminds you that you're not alone, that you belong, and that your presence matters more than you probably realize.
        </p>

        <p class="typing-text">
            I'm really grateful I met you.
            It happened in a way that felt unplanned â€” almost incidental â€” and yet it's become something I can't imagine being random.
            Some people pass through your life quickly; others arrive quietly and stay in ways you only understand later.
            You're the kind of person who listens without rushing, who shows up without needing to be asked,
            who somehow follows every half-formed thought, every strange idea, every sudden tangent â€” and makes space for all of it.
            That kind of understanding is rare, and I never take it for granted.
        </p>

        <p class="typing-text">
            What I'm trying to give you with this isn't just a birthday gesture.
            It's something that holds what words don't always manage to say:
            appreciation, trust, the comfort of being known.
            Something that says you mattered enough for this to be built for you.
            Because you do â€” more than you realize most days.
            And because the way you exist in my life â€” steady, thoughtful,
            present â€” means more than I could ever fit into a single message.
        </p>

        <p class="typing-text">
            There are people who bring light into your life without trying to.
            People you find yourself turning toward instinctively, the way sunflowers turn toward the sun â€” not because they're told to,
            but because that's where warmth lives.
            You've been that kind of presence for me, Sunny.
            And I hope, quietly and consistently, I can be that for you too.
        </p>

        <p class="typing-text">
            Turning eighteen feels like standing at the edge of something new.
            Not because everything suddenly changes â€” but because the world opens a little wider,
            and the choices begin to feel more like your own.
            There is so much ahead of you.
            I'm really excited to watch it unfold.
        </p>

        <p class="typing-text" style="margin-top:30px; font-weight:900;">
            â€” With all my love,
            Z ðŸŒ»
        </p>
    </div>
</main>

<script src="js/script.js"></script>

<script>
    const MESSAGE_PRIVATE_KEY = "9876";

    window.showMessageGate = function () {
        const msgGate = document.getElementById('message-auth-gate');
        if (msgGate) {
            msgGate.style.cssText = 'display:flex; position:fixed; inset:0; background:#000; z-index:20000; justify-content:center; align-items:center;';
        }
        setTimeout(() => {
            const input = document.getElementById('message-pass-input');
            if (input) input.focus();
        }, 100);
    };

    window.unlockMessage = function () {
        const input = document.getElementById('message-pass-input');
        if (!input) return;

        if (input.value === MESSAGE_PRIVATE_KEY) {
            localStorage.setItem('message_unlocked', 'true');
            document.getElementById('message-auth-gate').remove();
            document.querySelector('nav').style.display = '';
            document.querySelector('main').style.display = '';
            if (typeof initCustomCursor === 'function') initCustomCursor();
            startTypingEffect();
        } else {
            input.style.borderColor = "#ff3b30";
            input.value = "";
            input.placeholder = "Wrong key";
            setTimeout(() => {
                input.placeholder = "â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢";
                input.style.borderColor = "rgba(255,255,255,0.1)";
            }, 2000);
        }
    };

    function startTypingEffect() {
        const elements = document.querySelectorAll('.typing-text');
        const paragraphs = Array.from(elements).map(el => {
            const text = el.textContent.trim();
            el.textContent = '';
            return { el, text };
        });

        function typePara(p, i) {
            if (p >= paragraphs.length) return;
            if (i >= paragraphs[p].text.length) {
                setTimeout(() => typePara(p + 1, 0), 400);
                return;
            }
            paragraphs[p].el.textContent += paragraphs[p].text[i];
            setTimeout(() => typePara(p, i + 1), 30);
        }

        setTimeout(() => typePara(0, 0), 500);
    }

    document.addEventListener("keydown", e => {
        if (e.key === "Enter") {
            const msgGate = document.getElementById('message-auth-gate');
            if (msgGate && msgGate.style.display !== 'none') {
                unlockMessage();
            }
        }
    });

    document.addEventListener("DOMContentLoaded", () => {
        const hubUnlocked = localStorage.getItem('hub_unlocked') === 'true';
        const msgUnlocked = localStorage.getItem('message_unlocked') === 'true';

        const mainGate = document.getElementById('auth-gate');

        if (hubUnlocked) {
            if (mainGate) mainGate.remove();

            if (msgUnlocked) {
                const msgGate = document.getElementById('message-auth-gate');
                if (msgGate) msgGate.remove();
                document.querySelector('nav').style.display = '';
                document.querySelector('main').style.display = '';
                if (typeof initCustomCursor === 'function') initCustomCursor();
                startTypingEffect();
            } else {
                showMessageGate();
            }
        }
    });

    const _origUnlockHub = window.unlockHub;
    window.unlockHub = function () {
        const input = document.getElementById('pass-input');
        const ACCESS_KEY = "1234";
        if (input && input.value === ACCESS_KEY) {
            localStorage.setItem('hub_unlocked', 'true');
            const mainGate = document.getElementById('auth-gate');
            if (mainGate) mainGate.remove();
            showMessageGate();
        } else if (input) {
            input.style.borderColor = "#ff3b30";
            input.value = "";
            input.placeholder = "Wrong key";
            setTimeout(() => {
                input.placeholder = "â€¢â€¢â€¢â€¢";
                input.style.borderColor = "rgba(255, 255, 255, 0.1)";
            }, 2000);
        }
    };
</script>

</body>
</html>